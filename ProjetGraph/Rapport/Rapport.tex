\input{header.tex}
\title{Rapport - Projet Graph}
\fancyhf{}
\lhead{\leftmark}
\lfoot{COLEAU Victor \& COUCHOUD Thomas}
\rfoot{Page~\thepage}

\begin{document}
	\maketitle
	\tableofcontents
	\chapter{Présentation du sujet}
		L'objectif de ce projet est de réaliser une librairie de classes et de fonctions permettant de manipuler des graphs. Celle-ci devra nous permettre de stocker en mémoire des graphs ainsi que leurs composants, à savoir des sommets et des arcs. De plus, il devra être possible d'effectuer des actions basiques telles qu'ajouter ou supprimer des éléments.
		
		Enfin, il devra être possible de générer des graphs en important leur structure depuis des fichiers texte externes formatés comme indiqué dans le sujet.
	
	\chapter{Architecture}
		Avant toute chose, il est à noter la présence d'une classe CHashMap. Celle-ci fonctionne sur le principe d'une liste clé-valeur et nous permet principalement de stocker des informations pouvant avoir des noms différents d'un graph à l'autre.
		
		\begin{itemize}
			\item Le nombre de propriétés stockées.
			\item La liste des clés (chaines de caractères).
			\item La liste des valeurs (double).
		\end{itemize}
		
		Elle contient les méthodes suivantes :
		\begin{itemize}
			\item L'ajout d'une clé et de sa valeur.
			\item Modifier la valeur d'une clé donnée.
			\item Supprimer une clé.
			\item Nettoyage de toutes les clé et valeur.
			\item L'opérateur d'affectation duplicant l'ensemble des clé-valeur dans un autre HashMap.
		\end{itemize}
	
		La classe centrale de notre projet est CGraph. Celle-ci représente un graph. Y sont stockées les informations suivantes:
		\begin{itemize}
			\item Le nombre de sommets contenus dans le graph.
			\item L'indice du plus grand sommet du graph (choix expliqué par la suite).
			\item Un tableau 1D contenant des pointeurs sur les objets sommets.\\
		\end{itemize}
		De plus, cette classe contient l'ensemble des méthodes demandées telles que :
		\begin{itemize}
			\item L'ajout d'un sommet au graph.
			\item La suppression d'un sommet du graph.
			\item La vérification de l'existance d'un sommet dans le graph.
			\item L'ajout d'un arc (orienté) entre deux sommets existants.
			\item La suppression d'un arc entre deux sommets.
			\item La modification d'un arc par redirection de son sommet d'arrivé.
			\item La vérification de l'existance d'un arc dans le graph.
			\item L'ajout d'un lien (arc dans les deux sens) entre deux sommets.
			\item L'ajout d'une propriété (et sa valeur) pour un sommet donné.
			\item La modification de la valeur d'une propriété pour un sommet donné.
			\item La lecture de la valeur d'une propriété donnée pour un sommet donné.
			\item La suppression d'une propriété pour un sommet donné.
			\item L'ajout d'une propriété (et de sa valeur) d'un arc entre deux sommets donnés.
			\item La modification de la valeur d'une propriété d'un arc entre deux sommets donnés.
			\item La lecture de la valeur d'une propriété d'un arc entre deux sommets donnés.
			\item La suppression d'une propriété d'un arc entre deux sommets donnés.
			\item L'inversion du graph (invertion de tous les arcs).
			\item Le nettoyage du graph.
			\item L'affichage du graph.
			\item L'opérateur d'addition ajoutant un sommet.
			\item L'opérateur de soustraction supprimant un sommet.
			\item L'opérateur d'affectation duplicant un graph dans un autre.\\
		\end{itemize}
		
		Deux autres classes se distinguent par leur importance : CVertex (un sommet) et CArc (un arc).\\
		
		La classe CVertex contient les informations suivantes.
		\begin{itemize}
			\item L'indice du sommet.
			\item Le nombre d'arcs entrants.
			\item Un tableau 1D de pointeurs sur les arcs entrants.
			\item Le nombre d'arcs sortants.
			\item Un tableau 1D de pointeurs sur les arcs sortants.
			\item Un CHashMap de ces propriétés.\\
		\end{itemize}
		Cette classe contient des méthodes servants principalement à modifier les arcs contenus.
		\begin{itemize}
			\item L'accesseur à l'indice du sommet.
			\item L'accesseur au nombre d'arcs entrants.
			\item L'accesseur au nombre d'arcs sortants.
			\item L'ajout (par la création) d'un arc entrant.
			\item La suppression d'un arc entrant.
			\item La modification d'un arc entrant.
			\item L'ajout (par la création) d'un arc sortant.
			\item La suppression d'un arc sortant.
			\item La modification d'un arc sortant.
			\item La vérification de l'existance d'un arc entrant.
			\item La vérification de l'existance d'un arc sortant.
			\item L'ajout d'une propriété (et de sa valeur).
			\item La modification de la valeur d'une propriété.
			\item La lecture de la valeur d'une propriété.
			\item La suppression d'une propriété.
			\item L'ajout d'une propriété (et de sa valeur) d'un un arc sortant vers un sommet donné.
			\item La modification de la valeur d'une propriété d'un arc sortant vers un sommet donné.
			\item La lecture de la valeur d'une propriété d'un arc sortant vers un sommet donné.
			\item La suppression d'une propriété d'un arc sortant vers un sommet donné.
			\item L'affichage des arcs entrants.
			\item L'affichage des arcs sortants.
			\item L'invertion des arcs.
			\item L'opérateur d'affectation duplicant le contenu d'un sommet dans un autre.\\
		\end{itemize}
		
		La classe CArc ne contient que peu d'informations.
		\begin{itemize}
			\item L'indice du sommet pointé par l'arc.
			\item Un HashMap de ces prorpiétés.\\
		\end{itemize}
		Elle contient les méthodes suivantes :
		\begin{itemize}
			\item L'accesseur à l'indice de l'arc.
			\item Le mutateur de l'indice de l'arc.
			\item L'ajout d'une propriété (et de sa valeur).
			\item La modification de la valeur d'une propriété.
			\item La lecture de la valeur d'une propriété.
			\item La suppression d'une propriété.
			\item L'opérateur d'affectation duplicant un arc.\\
		\end{itemize}
		
		Afin de pouvoir lire des graphs externes au programme, nous avons implémenté une classe statique CGraphParser. Cette dernière propose différentes fonction permettant la lecture d'un fichier. Nous avons par exemple la possibilité de lire une ligne, la découper selon un caractère etc. Grâce à celle-ci, le constructeur prenant en paramètre un nom de fichier va pouvoir lire de manière plus aisée le ficher graph. Si des prorpiétés sont attendues, celles-ci devront de situer après les ID correspondants (ID du sommet pour une propriété d'une sommet ou après les ID des deux sommets pour une propriété d'un arc).
		
		
		\img{../../classDiagram.png}{Diagramme de classes}{0.42}{0}
		
	\chapter{Choix de codage}
		Avant tout chose, nous avons prit la décision de créer un fichier nommé "utils.h". Celui-ci contient des macros permettant de compiler sous Visual Studio et un système Unix (utilisation des méthodes propres à chaque compilateur). De plus, il contient un certain nombre de macros utilitaires, notamment MMALLOC et RREALLOC allouant l'espace mémoire demandé tout en vérifiant le bon déroulement.\\
	
		Un point important est l'absence d'accesseurs des objets CVertex et CArc depuis un graph. De cette façon, l'utilisateur ne peut pas modifier un sommet ou un arc appartenant à un graph en appelant les méthodes de CVertex ou de CArc directement sur l'objet en question. Il est obligé de passer par les méthodes de CGraph qui appeleront elles-mêmes les sous-méthodes nécessaires.\\
		Cela évite qu'un sommet (ou un arc) soit ajouté, modifié ou supprimé sans que l'objet graph n'en soit informé ce qui évite un état incohérent du graph..\\
		
		Un deuxième choix important est le stockage des sommets dans le graph. Plutôt que d'ajouter à la suite tous les sommets dans un tableau (stockage par ordre d'arrivé), nous posons chaque sommet à la position du tableau égale à l'indice du sommet moins 1. Ainsi le sommet 1 est à la position 0, le 10 à la position 9, etc..
		
	
		Concernant le parser, nous avons fait le choix de séparer les méthodes "utilitaires" dans une classe CGraphParser. En effet de cette manière cette classe pourra être réutilisée par la suite pour lire des fichiers similaire. La partie propre a l'interprétation d'un fichier graph se fait dans le constructeur CGraph.
		
		Une classe CHashMap est disponible afin de pouvoir stocker les différentes propriétés que peuvent avoir les sommets ou arcs. Par manque de temps, celle-ci ne gère que des doubles.
		
		Nous avons choisi de stocker les propriétés des chemins uniquement dans les arcs sortants de chaque sommet. En effet, dupliquer cette information dans les arcs entrants entraine un redondance des données et est plus contraignant à garder cohérent.
	\chapter{Tests effectués}
		Afin de pouvoir valider le fonctionnement de notre code, nous avons réalisé de nombreux tests. Certains ont été réalisés manuellement mais un bon nombre d'entre eux ont été écrits sous forme de "test unitaires". Ceux-ci sont présents dans les fichiers CXXXTest.cpp qui vont respectivement tester leur classe XXX.
		
		Nous sommes conscients que les tests sont très minimalistes et ne couvrent pas tout, cependant cela est déjà un bon départ pour vérifier un fonctionnement "normal". De plus chaque test n'est effectué qu'une seule fois ce qui peut mettre en doute l'efficacité de ceux-ci.
		
		Commençons par CExceptionUnit:
		\begin{itemize}
			\item Tests des différents constructeur impliquant l'ID de l'exception ainsi que des getters et setters de celui-ci.
			\item Tests des différents constructeur impliquant le message de l'exception ainsi que des getters et setters de celui-ci.\\
		\end{itemize}
		Ceux-ci sont très généralistes mais couvrent relativement bien les différentes utilisations d'un objet de cette classe.
		
		Les tests de CHashMap sont les suivants:
		\begin{itemize}
			\item Test de récupération d'une valeur non existante.
			\item Test de modification d'une valeur non existante.
			\item Test de l'ajout et récupération d'une valeur.
			\item Test d'ajout une valeur dupliquée.
			\item Test de la suppression d'une valeur.
		\end{itemize}
		
		Intéressons-nous maintenant à CArc:
		\begin{itemize}
			\item Test de la création d'un arc sans paramètres.
			\item Test de la création d'un arc avec une destination et vérification de l'accesseur associé.
			\item Test de la modification de la destination d'un arc.
		\end{itemize}
		
		Passons ensuite aux tests contenus dans CVertex:
		\begin{itemize}
			\item Test de la création d'un sommet sans paramètres.
			\item Test de la création d'un sommet avec un ID et vérification de l'accesseur associé.
			\item Test de l'ajout d'un arc entrant.
			\item Test de la fonction indiquant si un arc entrant existe.
			\item Test de l'ajout d'un arc entrant dupliqué.
			\item Test de la suppression d'un arc entrant.
			\item Test de la suppression d'un arc entrant n'existant pas.
			\item Test de la modification d'un arc entrant.
			\item Test de la modification d'un arc entrant n'existant pas.
			\item Test de l'ajout d'un arc sortant.
			\item Test de la fonction indiquant si un arc sortant existe.
			\item Test de l'ajout d'un arc sortant dupliqué.
			\item Test de la suppression d'un arc sortant.
			\item Test de la suppression d'un arc sortant n'existant pas.
			\item Test de la modification d'un arc sortant.
			\item Test de la modification d'un arc sortant n'existant pas.
			\item Test de l'opérateur =.
			\item Test du constructeur de recopie.
		\end{itemize}
		
		Etudions dès à présent CGraph:
		\begin{itemize}
			\item Test de l'ajout d'un sommet.
			\item Test de la fonction indiquant si un sommet existe.
			\item Test de la suppression d'un sommet.
			\item Test de la suppression d'un sommet n'existant pas.
			\item Test de l'opérateur +.
			\item Test de l'opérateur -.
			\item Test de la fonction renvoyant le nombre de sommets du graph.
			\item Test de la fonction renvoyant la liste des ID de tous les sommets.
			\item Test de l'ajout d'un arc.
			\item Test de la suppression d'un arc.
			\item Test de l'ajout d'un arc avec une destination inexistante.
			\item Test de la suppression d'un arc avec une destination inexistante.
			\item Test de l'ajout d'un arc avec un départ inexistant.
			\item Test de la suppression d'un arc avec un départ inexistant.
			\item Test de la modification d'un arc.
			\item Test de la modification d'un arc avec des sommets inexistants.
			\item Test de l'ajout d'un lien.
			\item Test de la suppression d'un sommet contenant des arcs entrants/sortants.
			\item Test de l'opérateur =.
			\item Test du constructeur prenant un fichier en paramètre.
		\end{itemize}
		
		Enfin les derniers tests sont effectués dans CGraphParser:
		\begin{itemize}
			\item Test de la fonction pour obtenir la partie valeur.
			\item Test de la fonction pour obtenir la partie clef.
			\item Test de la fonction permettant de couper un string selon des délimiteurs.
			\item Test de la fonction permettant de renvoyer un tableau après une découpe par délimiteur.
			\item Test de la fonction permettant de raccourcir un string en retirant les caractères non utiles en début et fin de string.
		\end{itemize}
	
	\chapter{Conseils d'utilisation}
	Le programme a été conçu et compilé de sorte que l'exécutable puisse prendre en arguments un fichier source de graph formaté comme défini dans le sujet.
	
	Suite à cela, il va exécuter les instructions suivantes :
	\begin{itemize}
		\item Affichage du graph.
		\item Création d'un nouveau graph étant l'inverse du premier.
		\item Affichage de ce dernier. \\
	\end{itemize}
	Pour une utilisation en tant que librairie, tout se fait a partir d'un objet CGraph. Bien que des sommets et arcs peuvent être instanciés hors d'un graph, ceux-ci ne pourront être inclus dans le graph. Tout objet interne au graph devra et sera construit par les méthodes appropriées du graph.
	
	Il est de plus possible d'ajouter des propriétés sur un arc ou un sommet afin de pouvoir étendre les capacités d'une simple visualisation de notre simple librairie.

	Pour toute information supplémentaire sur les méthodes, se référer aux cartouches d'entête présents dans les fichiers .h.
\end{document}
